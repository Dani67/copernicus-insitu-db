{% extends '_layout.html' %}
{% load static %}

{% block title %}Reports{% endblock %}

{% block style %}
  <style>
    label {
      text-align: right;
      clear: both;
      float:left;
      margin-right:15px;
    }
  </style>
{% endblock %}

{% block content %}
<div class="row">
  <h1>
    <p class="col-sm-12">Report</p>
    <p class="col-sm-12"><small>{{ query.title }}</small></p>
  </h1>
</div>

<div class="row">
  <table id="detail-table" class="table borderless col-sm-12">
    <tbody>
      <tr class="row">
        <th class="col-md-4 col-sm-6">Description</th>
        <td class="col-md-8 col-sm-6">{{ query.description }}</td>
      </tr>
    </tbody>
  </table>
</div>


<div class="row">
  <div class="col-lg-12">
    <div class="panel panel-default">
      <div class="panel-heading">Filters</div>
        <div class="panel-body form-inline filters">
          {% for param, value in query.params.items %}
            <div class="form-group filters-style">
              <label for="{{ param }}" class="control-label">{{ param }}</label><br>
              <input id="{{ param }}" class="form-control" value="{{ value }}"/>
            </div>
            </br>
          {% endfor %}
        </div>
    </div>
  </div>
</div>
<a class="btn btn-primary" id="download-excel-btn" download>Download Excel</a>
{% endblock %}


{% block scripts %}
<script type="text/javascript">
  $('#download-excel-btn').on('click', function () {
    var url = '/reports/{{ query.id }}/download?format=excel&params=';
    {% for param in query.params %}
      url += '{{param}}' + ':' + $('#{{param}}').val();
      url += '|';
    {% endfor %}
    url = url.slice(0, -1);
    $("#download-excel-btn").attr("href", url);
  });

</script>
{% endblock %}
